<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
</head>
<body>
<h2 id="typerocketforlaravel5.3">TypeRocket for Laravel 5.3</h2>

<p>Originally for WordPress, TypeRocket makes building advanced forms and fields easy for Laravel too.</p>

<p>See http://typerocket.com for documentation (mainly for WordPress).</p>

<h3 id="installing">Installing</h3>

<pre><code>composer require typerocket/laravel
</code></pre>

<p><a href="https://laravel.com/docs/5.3/providers#registering-providers">Laravel Service Providers</a> make a way for extending Laravel. TypeRocket Laravel 2.0 is a service provider for Laravel. In your <code>config/app.php</code> file add:</p>

<pre><code class="php">'providers' =&gt; [
    // Other Service Providers

    TypeRocket\Service::class,
],
</code></pre>

<p>Then form the command line:</p>

<pre><code>php artisan vendor:publish --provider=&quot;TypeRocket\Service&quot;
</code></pre>

<p>You can now access the <code>config/typerocket.php</code>.</p>

<p>Finally, add uploads to public folder. From your site root directory run:</p>

<pre><code>ln -s ../storage/uploads uploads
</code></pre>

<h3 id=".env">.env</h3>

<p>Example settings.</p>

<pre><code>TR_MATRIX_API_URL=/matrix_api
TR_FORM_PROVIDER=\TypeRocket\Form
TR_JS_URL=/js/tr
TR_CSS_URL=/css/tr
TR_DEBUG=true
TR_DOMAIN=App
</code></pre>

<h2 id="jsandcssinit">JS and CSS init</h2>

<p>In blade templates such master templates.</p>

<pre><code>{!! \TypeRocket\Assets::getHeadString() !!}
{!! \TypeRocket\Assets::getFooterString() !!}
</code></pre>

<h3 id="addingassets">Adding assets</h3>

<pre><code class="php">$paths = Config::getPaths();

// type ( js || css), id, path
Assets::addToFooter('js', 'typerocket-core', $paths['urls']['js'] . '/typerocket.js');
Assets::addToHead('js', 'typerocket-global', $paths['urls']['js'] . '/global.js');
</code></pre>

<h2 id="forms">Forms</h2>

<pre><code class="php">// model, action ( create || update ), id, path
$form = new \TypeRocket\Form('Post', 'update', $id, '/posts/' . $id);
</code></pre>

<pre><code class="php">&lt;div class=&quot;typerocket-container&quot;&gt;
    {!! $form-&gt;open() !!}
    {!! $form-&gt;text('title')-&gt;setLabel('Post Title') !!}
    {!! $form-&gt;checkbox('publish')-&gt;setText('Published') !!}
    {!! $form-&gt;close('Submit') !!}
&lt;/div&gt;
</code></pre>

<h2 id="requestoldinput">Request Old Input</h2>

<p>To load old input into the form set the request.</p>

<pre><code class="php">class PostController extends Controller
{
    public function create(Request $request)
    {
        $form = new \TypeRocket\Form('Post', 'create', null, '/posts/');
        $form-&gt;setRequest($request); // set request
        return view('posts.create', ['form' =&gt; $form]);
    }
}
</code></pre>

<h2 id="validate">Validate</h2>

<pre><code class="php">class PostController extends Controller
{

    public function store(Request $request)
    {
        $tr = $request-&gt;input('tr');

        $validator = \Validator::make($tr, [
            'title' =&gt; 'required|max:255'
        ]);

        if ($validator-&gt;fails()) {
            return redirect(&quot;posts/create&quot;)
                -&gt;withErrors($validator)
                -&gt;withInput();
        }

        $post = new Fabric();
        $post-&gt;title = $tr['title'];
        $post-&gt;save();

        header('Location: /posts/');
    }

}
</code></pre>

<h2 id="matrixroute.">Matrix route.</h2>

<p>Working with matrix fields the service provider will add this for you.</p>

<pre><code class="php">Route::post('matrix_api/{group}/{type}', function($group, $type) {
    (new TypeRocket\Matrix())-&gt;route($group, $type);
});
</code></pre>

<h3 id="csfrformatrix">CSFR for matrix</h3>

<pre><code class="php">&lt;?php

namespace App\Http\Middleware;

use Illuminate\Foundation\Http\Middleware\VerifyCsrfToken as BaseVerifier;

class VerifyCsrfToken extends BaseVerifier
{
    /**
     * The URIs that should be excluded from CSRF verification.
     *
     * @var array
     */
    protected $except = [
        'matrix_api/*' // added
    ];
}
</code></pre>

<h2 id="matrixassets">Matrix Assets</h2>

<p>Assets will not be loaded form fields because the view is already loaded. Include the possible assets in the controller.</p>

<p>For example a Matrix field that uses an image field will need to include <code>image.js</code>.</p>

<pre><code class="php">$paths = \TypeRocket\Config::getPaths();
\TypeRocket\Assets::addToFooter('js', 'typerocket-image', $paths['urls']['js'] . '/image.js');
</code></pre>

</body>
</html>
